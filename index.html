<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>值专止抓 指址专职指 职-100 </title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --wood: #8D6E63; --leaf: #66BB6A; --sky: #E3F2FD; --path: #D7CCC8; }
        body { 
            font-family: 'Assistant', sans-serif; margin: 0; padding: 0;
            background: linear-gradient(to bottom, var(--sky) 50%, var(--leaf) 50%);
            height: 100vh; display: flex; flex-direction: column; align-items: center; overflow: hidden;
        }

        /*  转专 */
        .board {
            background: #FFF9C4; border: 6px solid var(--wood); padding: 15px 30px;
            border-radius: 20px; font-size: 2.5rem; font-weight: 800; color: #5D4037;
            margin-top: 20px; box-shadow: 0 8px 0 rgba(0,0,0,0.1); z-index: 5;
        }

        /* 住 转拽转 */
        .track-container {
            position: absolute; bottom: 100px; width: 90%; height: 60px;
            background: rgba(0,0,0,0.05); border-radius: 30px; display: flex; align-items: center; padding: 0 10px;
        }
        .finish-line { position: absolute; right: 0; font-size: 2rem; }
        .start-line { position: absolute; left: 0; font-size: 1.2rem; font-weight: bold; color: var(--wood); }

        /* 专 */
        #rabbit { 
            font-size: 3.5rem; position: absolute; bottom: 110px; left: 0;
            transition: all 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 10;
        }

        .answers { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px; }
        .ans-card {
            background: white; border: 4px solid var(--wood); width: 100px; height: 60px;
            border-radius: 15px; display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; font-weight: bold; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 0 var(--wood);
        }
        .ans-card:active { transform: translateY(3px); box-shadow: none; }

        .progress-text { position: absolute; bottom: 40px; font-weight: 800; color: white; font-size: 1.5rem; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); }
        .screen { display: none; flex-direction: column; align-items: center; justify-content: center; width: 100%; height: 100%; text-align: center; }
        .active { display: flex; }
    </style>
</head>
<body>

    <audio id="bg-music" loop src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>
    <audio id="clap" src="https://www.soundjay.com/human/applause-01.mp3"></audio>
    <audio id="fail" src="https://www.myinstants.com/media/sounds/clown-laugh.mp3"></audio>

    <div id="name-screen" class="screen active">
        <h1 style="color: #388E3C; font-size: 2.5rem;">值专止抓 指址专职指 职-100! </h1>
        <input type="text" id="user-name" placeholder="值职 拽止专职执 职指?" style="padding:15px; font-size:1.5rem; border-radius:15px; border:3px solid var(--wood); text-align:center;">
        <button onclick="startApp()" style="margin-top:20px; padding:15px 40px; font-size:1.5rem; background:#FF7043; color:white; border:none; border-radius:50px; cursor:pointer; font-weight:bold;">址旨值专止抓! </button>
    </div>

    <div id="game-screen" class="screen">
        <div class="board" id="q-text"> 旨止注值... </div>
        <div class="answers" id="options"></div>

        <div id="rabbit"></div>
        <div class="track-container">
            <div class="start-line">0</div>
            <div class="finish-line"> 100</div>
        </div>
        
        <div class="progress-text">指址专职指 旨职侄专职指拽: <span id="pos-display">0</span> 转 100</div>
    </div>

    <script>
        let userName = "";
        let rabbitPos = 0; // 拽 砖 专 (0 注 100)
        let correctAns = 0;

        function startApp() {
            userName = document.getElementById('user-name').value;
            if(!userName) return;
            document.getElementById('name-screen').classList.remove('active');
            document.getElementById('game-screen').classList.add('active');
            document.getElementById('bg-music').volume = 0.1;
            document.getElementById('bg-music').play().catch(() => {});
            newRound();
        }

        function newRound() {
            // 拽注转 专转 拽砖 驻 拽 ( 20 爪注 拽砖 注)
            let difficulty = Math.floor(rabbitPos / 20) + 1; 
            let range = 5 + (difficulty * 5); // 转 -10  注 30+
            
            let isPlus = Math.random() > 0.5;
            let a = Math.floor(Math.random() * range) + 2;
            let b = Math.floor(Math.random() * range) + 2;

            if (isPlus) {
                correctAns = a + b;
                document.getElementById('q-text').innerText = `${a} + ${b} = ?`;
            } else {
                if (a < b) [a, b] = [b, a];
                correctAns = a - b;
                document.getElementById('q-text').innerText = `${a} - ${b} = ?`;
            }

            let opts = [correctAns];
            while(opts.length < 4) {
                let r = Math.floor(Math.random() * (range * 2)) + 1;
                if(!opts.includes(r)) opts.push(r);
            }
            opts.sort((x, y) => x - y);
            document.getElementById('options').innerHTML = opts.map(o => `<div class="ans-card" onclick="check(${o})">${o}</div>`).join('');
        }

        function updateRabbitUI() {
            const rabbit = document.getElementById('rabbit');
            const posDisplay = document.getElementById('pos-display');
            
            // 砖  转拽转 注 住
            let percentage = Math.min(rabbitPos, 100);
            rabbit.style.left = `calc(${percentage}% - 50px)`;
            posDisplay.innerText = rabbitPos;

            if (rabbitPos >= 100) {
                confetti({ particleCount: 200, spread: 100 });
                document.getElementById('q-text').innerText = "旨指 址旨指止! 执爪旨址职转旨指!";
                document.getElementById('options').innerHTML = `<button onclick="location.reload()" style="padding:10px 20px; border-radius:20px; background:var(--leaf); color:white; border:none; font-weight:bold;">执砖职指拽 指指砖</button>`;
            }
        }

        function check(val) {
            if (val === correctAns) {
                rabbitPos += 5; // 转拽 5 爪注  转砖 
                document.getElementById('clap').play();
                confetti({ particleCount: 50, spread: 30, origin: { y: 0.8 } });
                updateRabbitUI();
                if (rabbitPos < 100) setTimeout(newRound, 1200);
            } else {
                rabbitPos = Math.max(0, rabbitPos - 3); // 注转 专 3 爪注 专
                document.getElementById('fail').play();
                document.getElementById('q-text').style.color = "red";
                updateRabbitUI();
                setTimeout(() => {
                    document.getElementById('q-text').style.color = "#5D4037";
                    newRound();
                }, 1000);
            }
        }
    </script>
</body>
</html>
