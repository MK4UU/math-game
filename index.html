<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>×—Ö¶×©×Ö°×‘Ö¼×•Ö¹×Ÿ ×‘Ö¼Ö·×˜Ö¼Ö¶×‘Ö·×¢ ğŸ</title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --accent: #4CAF50; --bg-sky: #A7E6FF; }
        body { 
            font-family: 'Assistant', sans-serif; margin: 0; padding: 0;
            background: linear-gradient(to bottom, var(--bg-sky) 60%, #B2FF59 60%);
            height: 100vh; display: flex; flex-direction: column; align-items: center; overflow: hidden;
        }
        .screen { display: none; flex-direction: column; align-items: center; justify-content: center; width: 100%; height: 100%; text-align: center; }
        .active { display: flex; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .story-card {
            background: white; width: 85%; max-width: 600px; padding: 35px;
            border-radius: 40px; box-shadow: 0 15px 0px rgba(0,0,0,0.1);
            font-size: 2.2rem; font-weight: 700; line-height: 1.6; color: #333;
            margin-bottom: 30px; border: 6px solid #FFF;
        }
        .answers-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; max-width: 500px; }
        .ans-btn {
            width: 90px; height: 90px; border-radius: 50%; border: none;
            background: #7CB342; color: white; font-size: 2.2rem; font-weight: bold;
            cursor: pointer; box-shadow: 0 8px 0 #558B2F; transition: 0.1s;
        }
        .ans-btn:active { transform: translateY(4px); box-shadow: 0 2px 0 #558B2F; }
        .top-bar { width: 100%; display: flex; justify-content: space-around; padding: 20px; font-weight: bold; font-size: 1.4rem; color: #2E7D32; }
        .character { font-size: 5rem; margin-bottom: 5px; transition: transform 0.3s; }
        .input-name { padding: 15px; font-size: 1.8rem; border-radius: 20px; border: none; text-align: center; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .btn-start { padding: 15px 50px; font-size: 1.8rem; background: #FF7043; color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 6px 0 #D84315; font-weight: bold; }
    </style>
</head>
<body>

    <audio id="bg-music" loop src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>
    <audio id="clap-sound" src="https://actions.google.com/sounds/v1/human_voices/applause.ogg"></audio>
    <audio id="clown-sound" src="https://www.myinstants.com/media/sounds/clown-laugh.mp3"></audio>

    <div id="name-screen" class="screen active">
        <h1 style="color: #2E7D32; font-size: 3rem;">×Öµ×™×šÖ° ×§×•Ö¹×¨Ö°×Ö´×™× ×œÖ°×šÖ¸?</h1>
        <input type="text" id="user-name" class="input-name" placeholder="×”Ö·×›Ö°× Öµ×¡ ×©×Öµ×...">
        <button class="btn-start" onclick="saveName()">×‘Ö¼×•Ö¹××•Ö¼ × Ö°×©×‚Ö·×—Öµ×§! ğŸ</button>
    </div>

    <div id="game-screen" class="screen">
        <div class="top-bar">
            <div>×©×Ö¸×œ×•Ö¹×, <span id="display-name"></span>!</div>
            <div>â­ <span id="score">0</span></div>
        </div>
        <div class="character" id="char-img">ğŸ‘¦</div>
        <div class="story-card" id="question-text">×˜Ö¼×•Ö¹×¢Öµ×Ÿ ×©×Ö°×Öµ×œÖ¸×”...</div>
        <div class="answers-container" id="options"></div>
    </div>

    <script>
        let userName = localStorage.getItem('math_vocal_name') || "";
        let score = 0, correctAns = 0;

        const stories = [
            { t: "×œÖ°{name} ×”Ö¸×™×•Ö¼ {n1} ×ªÖ¼Ö·×¤Ö¼×•Ö¼×—Ö´×™×. ×Ö´×Ö¼Ö¸× × Ö¸×ªÖ°× Ö¸×” ×œ×•Ö¹ ×¢×•Ö¹×“ {n2}. ×›Ö¼Ö·×Ö¼Ö¸×” ×ªÖ¼Ö·×¤Ö¼×•Ö¼×—Ö´×™× ×™Öµ×©× ×œ×•Ö¹ ×¢Ö·×›Ö°×©×Ö¸×•?", op: "+" },
            { t: "×¢Ö·×œ ×”Ö¸×¢Öµ×¥ ×™Ö¸×©×Ö°×‘×•Ö¼ {n1} ×¦Ö´×¤Ö¼×•Ö¹×¨Ö´×™×. {n2} ×¦Ö´×¤Ö¼×•Ö¹×¨Ö´×™× ×¢Ö¸×¤×•Ö¼ ×œÖ·×©Ö¼×Ö¸×Ö·×™Ö´×. ×›Ö¼Ö·×Ö¼Ö¸×” ×¦Ö´×¤Ö¼×•Ö¹×¨Ö´×™× × Ö´×©×Ö°×Ö²×¨×•Ö¼?", op: "-" },
            { t: "×‘Ö¼Ö·×’Ö¼Ö´×™× Ö¸×” ×¤Ö¼Ö¸×¨Ö°×—×•Ö¼ {n1} ×¤Ö¼Ö°×¨Ö¸×—Ö´×™×. {name} ×§Ö¸×˜Ö·×£ {n2} ×¤Ö¼Ö°×¨Ö¸×—Ö´×™× ×™Ö¸×¤Ö´×™×. ×›Ö¼Ö·×Ö¼Ö¸×” ×¤Ö¼Ö°×¨Ö¸×—Ö´×™× × Ö´×©×Ö°×Ö²×¨×•Ö¼?", op: "-" },
            { t: "×œÖ°{name} ×”Ö¸×™×•Ö¼ {n1} ×‘Ö¼Ö·×œÖ¼×•Ö¹× Ö´×™×. {n2} ×‘Ö¼Ö·×œÖ¼×•Ö¹× Ö´×™× ×”Ö´×ªÖ°×¤Ö¼×•Ö¹×¦Ö°×¦×•Ö¼. ×›Ö¼Ö·×Ö¼Ö¸×” ×‘Ö¼Ö·×œÖ¼×•Ö¹× Ö´×™× × Ö´×©×Ö°×Ö²×¨×•Ö¼?", op: "-" },
            { t: "×‘Ö¼Ö·×§Ö¼Ö°×œÖ¸×Ö¸×¨ ×©×Ö¶×œ {name} ×”Ö¸×™×•Ö¼ {n1} ×¢Ö¶×¤Ö°×¨×•Ö¹× ×•Ö¹×ª. ×”×•Ö¼× ×§Ö´×‘Ö¼Öµ×œ ×¢×•Ö¹×“ {n2}. ×›Ö¼Ö·×Ö¼Ö¸×” ×¢Ö¶×¤Ö°×¨×•Ö¹× ×•Ö¹×ª ×™Öµ×©× ×œ×•Ö¹?", op: "+" }
        ];

        window.onload = () => { if(userName) startGame(); };

        function saveName() {
            userName = document.getElementById('user-name').value;
            if(userName.length < 2) return;
            localStorage.setItem('math_vocal_name', userName);
            startGame();
        }

        function startGame() {
            document.getElementById('display-name').innerText = userName;
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('game-screen').classList.add('active');
            
            // ×”×ª×—×œ×ª ××•×–×™×§×ª ×¨×§×¢
            const bgMusic = document.getElementById('bg-music');
            bgMusic.volume = 0.2;
            bgMusic.play().catch(e => console.log("Music blocked until user interacts"));

            generateQuestion();
        }

        function generateQuestion() {
            let story = stories[Math.floor(Math.random() * stories.length)];
            let n1 = Math.floor(Math.random() * 10) + 6;
            let n2 = Math.floor(Math.random() * 5) + 1;
            if(story.op === "+") correctAns = n1 + n2;
            else { if(n1 < n2) [n1, n2] = [n2, n1]; correctAns = n1 - n2; }

            document.getElementById('question-text').innerText = story.t.replace("{name}", userName).replace("{n1}", n1).replace("{n2}", n2);

            let options = [correctAns];
            while(options.length < 5) {
                let rand = correctAns + Math.floor(Math.random() * 8) - 4;
                if(rand >= 0 && !options.includes(rand)) options.push(rand);
            }
            options.sort((a, b) => a - b);
            document.getElementById('options').innerHTML = options.map(opt => `<button class="ans-btn" onclick="check(${opt})">${opt}</button>`).join('');
        }

        function check(val) {
            if(val === correctAns) {
                score += 10;
                document.getElementById('score').innerText = score;
                
                // ××¤×§×˜×™× ×©×œ × ×™×¦×—×•×Ÿ
                document.getElementById('clap-sound').play();
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                
                const char = document.getElementById('char-img');
                char.style.transform = "translateY(-30px) scale(1.3)";
                setTimeout(() => {
                    char.style.transform = "translateY(0) scale(1)";
                    generateQuestion();
                }, 1500);
            } else {
                // ××¤×§×˜ ×©×œ ×˜×¢×•×ª - ×œ×™×¦×Ÿ ×¦×•×—×§
                document.getElementById('clown-sound').play();
                document.getElementById('question-text').style.color = "red";
                document.getElementById('char-img').style.transform = "rotate(20deg)";
                setTimeout(() => { 
                    document.getElementById('question-text').style.color = "#333"; 
                    document.getElementById('char-img').style.transform = "rotate(0deg)";
                }, 800);
            }
        }
    </script>
</body>
</html>
