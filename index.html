<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>×—×©×‘×•×Ÿ ×‘×˜×‘×¢ ğŸ</title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --accent: #4CAF50; --bg-sky: #87CEEB; }
        body { 
            font-family: 'Assistant', sans-serif; margin: 0; padding: 0;
            background: linear-gradient(to bottom, var(--bg-sky) 60%, #91cf50 60%);
            height: 100vh; display: flex; flex-direction: column; align-items: center; overflow: hidden;
        }

        /* ××¡×š ×¤×ª×™×—×” */
        .screen { display: none; flex-direction: column; align-items: center; justify-content: center; width: 100%; height: 100%; text-align: center; }
        .active { display: flex; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* ×œ×•×— ×”×©××œ×” */
        .story-card {
            background: white; width: 85%; max-width: 600px; padding: 30px;
            border-radius: 30px; box-shadow: 0 15px 30px rgba(0,0,0,0.2);
            font-size: 1.8rem; font-weight: 700; line-height: 1.5; color: #333;
            margin-bottom: 30px; position: relative; border-bottom: 8px solid #ddd;
        }

        /* ×›×¤×ª×•×¨×™ ×ª×©×•×‘×” (×›××• ×‘-TinyTap) */
        .answers-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; max-width: 500px; }
        .ans-btn {
            width: 80px; height: 80px; border-radius: 50%; border: none;
            background: #91cf50; color: white; font-size: 1.8rem; font-weight: bold;
            cursor: pointer; box-shadow: 0 6px 0 #689f38; transition: 0.1s;
        }
        .ans-btn:active { transform: translateY(4px); box-shadow: 0 2px 0 #689f38; }

        /* ×›× ×™×¡×ª ×©× */
        .input-name { padding: 15px; font-size: 1.5rem; border-radius: 20px; border: 4px solid #fff; text-align: center; margin-bottom: 20px; }
        .btn-start { padding: 15px 40px; font-size: 1.5rem; background: #ff5722; color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 5px 0 #e64a19; }

        /* ×¡×˜×˜×•×¡ */
        .top-bar { width: 100%; display: flex; justify-content: space-around; padding: 15px; font-weight: bold; font-size: 1.2rem; background: rgba(255,255,255,0.3); }
        .character { font-size: 4rem; margin-bottom: 10px; transition: 0.5s; }
    </style>
</head>
<body>

    <div id="name-screen" class="screen active">
        <h1 style="color: white; text-shadow: 2px 2px #333;">××™×š ×§×•×¨××™× ×œ×š?</h1>
        <input type="text" id="user-name" class="input-name" placeholder="×”×›× ×¡ ×©×...">
        <button class="btn-start" onclick="saveName()">×‘×•××• × ×©×—×§! ğŸ</button>
    </div>

    <div id="game-screen" class="screen">
        <div class="top-bar">
            <div>×’×™×‘×•×¨/×”: <span id="display-name"></span></div>
            <div>â­ <span id="score">0</span></div>
        </div>
        
        <div class="character" id="char-img">ğŸ‘¦</div>

        <div class="story-card" id="question-text">
            ×˜×•×¢×Ÿ ×©××œ×”...
        </div>

        <div class="answers-container" id="options">
            </div>

        <div style="margin-top: 20px; color: white; font-weight: bold;">× ×™×ª×Ÿ ×œ×”×§×™×© ×’× ×‘××§×œ×“×ª!</div>
    </div>

    <script>
        let userName = localStorage.getItem('math_tiny_name') || "";
        let score = 0;
        let correctAns = 0;

        const stories = [
            { t: "×œ{name} ×”×™×• {n1} ×ª×¤×•×—×™×. ××× × ×ª× ×” ×œ×• ×¢×•×“ {n2}. ×›××” ×ª×¤×•×—×™× ×™×© ×œ×• ×¢×›×©×™×•?", op: "+" },
            { t: "×¢×œ ×”×¢×¥ ×”×™×• {n1} ×¦×™×¤×•×¨×™×. {n2} ×¦×™×¤×•×¨×™× ×¢×¤×•. ×›××” × ×©××¨×•?", op: "-" },
            { t: "×‘×›×™×ª×” ×”×™×• {n1} ×™×œ×“×™×. {n2} ×™×œ×“×™× × ×›× ×¡×•. ×›××” ×™×œ×“×™× ×™×© ×‘×¡×š ×”×›×œ?", op: "+" },
            { t: "×œ{name} ×”×™×• {n1} ×©×§×œ×™×. ×”×•× ×§× ×” ××¨×˜×™×§ ×‘-{n2} ×©×§×œ×™×. ×›××” × ×©××¨ ×œ×•?", op: "-" },
            { t: "×‘×’×™× ×” ×¤×¨×—×• {n1} ×¤×¨×—×™×. {name} ×§×˜×£ {n2} ×¤×¨×—×™×. ×›××” ×¤×¨×—×™× × ×©××¨×• ×‘×’×™× ×”?", op: "-" }
        ];

        window.onload = () => { if(userName) startGame(); };

        function saveName() {
            userName = document.getElementById('user-name').value;
            if(userName.length < 2) return;
            localStorage.setItem('math_tiny_name', userName);
            startGame();
        }

        function startGame() {
            document.getElementById('display-name').innerText = userName;
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('game-screen').classList.add('active');
            generateQuestion();
        }

        function generateQuestion() {
            let story = stories[Math.floor(Math.random() * stories.length)];
            let n1 = Math.floor(Math.random() * 15) + 5;
            let n2 = Math.floor(Math.random() * 5) + 1;
            
            if(story.op === "+") correctAns = n1 + n2;
            else { 
                if(n1 < n2) [n1, n2] = [n2, n1];
                correctAns = n1 - n2; 
            }

            let text = story.t.replace("{name}", userName).replace("{n1}", n1).replace("{n2}", n2);
            document.getElementById('question-text').innerText = text;

            // ×™×¦×™×¨×ª ××¤×©×¨×•×™×•×ª (××—×ª × ×›×•× ×” ×•×”×©××¨ ×˜×•×¢×•×ª)
            let options = [correctAns];
            while(options.length < 5) {
                let rand = correctAns + Math.floor(Math.random() * 10) - 5;
                if(rand > 0 && !options.includes(rand)) options.push(rand);
            }
            options.sort((a, b) => a - b);

            let optionsHTML = "";
            options.forEach(opt => {
                optionsHTML += `<button class="ans-btn" onclick="check(${opt})">${opt}</button>`;
            });
            document.getElementById('options').innerHTML = optionsHTML;
        }

        function check(val) {
            if(val === correctAns) {
                score += 10;
                document.getElementById('score').innerText = score;
                confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
                document.getElementById('char-img').style.transform = "scale(1.3) rotate(10deg)";
                setTimeout(() => {
                    document.getElementById('char-img').style.transform = "scale(1) rotate(0deg)";
                    generateQuestion();
                }, 1500);
            } else {
                document.getElementById('question-text').style.color = "red";
                setTimeout(() => { document.getElementById('question-text').style.color = "#333"; }, 500);
            }
        }

        // ×ª××™×›×” ×‘××§×œ×“×ª
        window.addEventListener('keydown', (e) => {
            if(!isNaN(e.key) && e.key !== " ") {
                // ×× ×”×™×œ×“ ××§×™×© ××¡×¤×¨, × ×‘×“×•×§ ×× ×–×” × ×›×•×Ÿ (×œ×‘×¢×™×•×ª ×¢× ×ª×•×¦××” ×—×“ ×¡×¤×¨×ª×™×ª ××• × ×—×›×” ×œ-Enter)
                // ×›××Ÿ ×œ××¢×Ÿ ×”×¤×©×˜×•×ª ×‘× ×™×™×“ ×•×‘×¡×’× ×•×Ÿ ×˜×™× ×™-×˜××¤, ×”×œ×—×™×¦×” ×¢×œ ×”×›×¤×ª×•×¨×™× ×¢×“×™×¤×”.
            }
        });
    </script>
</body>
</html>
